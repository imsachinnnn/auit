{% extends 'base.html' %} 
{% load static %} 

{% block title %}Student Dashboard - {{ student.student_name }}{% endblock title %}

{% block styles %}
    {# This block is intentionally left empty. #}
    {# All styles should be loaded from your main.css file via base.html #}
{% endblock styles %}


{% block content %} 
<div class="container">
    <header class="page-header">
        <div class="title-group">

            <h1>Student Dashboard</h1>
        </div>
        <div class="header-actions">
            <button onclick="window.print()" class="action-btn">üñ®Ô∏è Print Details</button>
            <a href="{% url 'student_logout' %}" class="action-btn">Logout</a>
        </div>
    </header>

    <div class="profile-header-card">
        {% if student.studentdocuments.student_photo %}
            <img src="{{ student.studentdocuments.student_photo.url }}" alt="Student Photo" class="profile-photo">
        {% else %}
            <img src="https://placehold.co/180x180/EFEFEF/AAAAAA?text=No+Photo" alt="No Photo Available" class="profile-photo">
        {% endif %}
        <div class="profile-info">
            <h2>{{ student.student_name }}</h2>
            <p>{{ student.roll_number }} | {{ student.get_program_level_display }}</p>
            
            <div class="essential-links">
                <a href="{% url 'exam_timetable' %}">üìÖ Timetable</a>
                <a href="https://annamalaiuniversity.ac.in/aucoe/rs_view.php" target="_blank">üéì Results</a>
                <a href="#">‚úÖ Attendance</a>
                <a href="https://annamalaiuniversity.ac.in/studport/tf_general_pharmacy.php?fee=tf" target="_blank">üè´üí∞ Tution Fee Payment</a>
                <a href="https://annamalaiuniversity.ac.in/studport/epayment_rgl_hfee.php?mode=oNln" target="_blank">üè†üí∞ Hostel Fee Payment</a>
                <a href="#">‚úèÔ∏è Edit Profile</a>
                <a href="https://annamalaiuniversity.ac.in/" target="_blank">üè´ AU Main Site</a>
                <a href="{% url 'help_and_support' %}">‚ùì Help & Support</a>
            </div>
        </div>
    </div>

    <div class="dashboard-grid">
        <!-- === MAIN CONTENT (LEFT COLUMN) === -->
        <div class="main-content">
            <div class="card">
                <h2 class="card-title">Personal & Contact Info</h2>
                <div class="details-grid">
                    <div class="detail-item"><strong>Name</strong> <span>{{ student.student_name }}</span></div>
                    <div class="detail-item"><strong>Email</strong> <span>{{ student.student_email }}</span></div>
                    <div class="detail-item"><strong>Mobile</strong> <span>{{ student.personalinfo.student_mobile|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Date of Birth</strong> <span>{{ student.personalinfo.date_of_birth|date:"d M Y" }}</span></div>
                    <div class="detail-item"><strong>Gender</strong> <span>{{ student.personalinfo.gender|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Blood Group</strong> <span>{{ student.personalinfo.blood_group|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Community</strong> <span>{{ student.personalinfo.community|default:"N/A" }}</span></div>
                    <div class="detail-item">
                        <strong>Caste</strong>
                        <span>
                            {% if student.personalinfo.caste == 'Other' %}
                                {{ student.personalinfo.caste_other|default:"N/A" }}
                            {% else %}
                                {{ student.personalinfo.caste|default:"N/A" }}
                            {% endif %}
                        </span>
                    </div>
                    <div class="detail-item"><strong>Religion</strong> <span>{{ student.personalinfo.religion|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>UMIS ID</strong> <span>{{ student.personalinfo.umis_id|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>EMIS ID</strong> <span>{{ student.personalinfo.emis_id|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>ABC ID</strong> <span>{{ student.personalinfo.abc_id|default:"N/A" }}</span></div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Parent Details</h2>
                <div class="details-grid">
                    <div class="detail-item"><strong>Father's Name</strong> <span>{{ student.personalinfo.father_name|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Father's Mobile</strong> <span>{{ student.personalinfo.father_mobile|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Mother's Name</strong> <span>{{ student.personalinfo.mother_name|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Mother's Mobile</strong> <span>{{ student.personalinfo.mother_mobile|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Parent's Annual Income</strong> <span>{{ student.personalinfo.parent_annual_income|default:"N/A" }}</span></div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Academic History</h2>
                
                {% if student.academichistory.sslc_school_name %}
                <div class="academic-section">
                    <h4>SSLC Details</h4>
                    <div class="details-grid">
                        <div class="detail-item"><strong>School</strong> <span>{{ student.academichistory.sslc_school_name }}</span></div>
                        <div class="detail-item"><strong>Percentage</strong> <span>{{ student.academichistory.sslc_percentage }}%</span></div>
                        <div class="detail-item"><strong>Year of Passing</strong> <span>{{ student.academichistory.sslc_year_of_passing }}</span></div>
                    </div>
                </div>
                {% endif %}

                {% if student.academichistory.hsc_school_name %}
                <div class="academic-section">
                    <h4>HSC Details</h4>
                    <div class="details-grid">
                        <div class="detail-item"><strong>School</strong> <span>{{ student.academichistory.hsc_school_name }}</span></div>
                        <div class="detail-item"><strong>Percentage</strong> <span>{{ student.academichistory.hsc_percentage }}%</span></div>
                        <div class="detail-item"><strong>Year of Passing</strong> <span>{{ student.academichistory.hsc_year_of_passing }}</span></div>
                    </div>
                </div>
                {% endif %}
                
                {% if student.diplomadetails %}
                <div class="academic-section">
                    <h4>Diploma Details</h4>
                    <div class="details-grid">
                        <div class="detail-item"><strong>College</strong> <span>{{ student.diplomadetails.diploma_college_name }}</span></div>
                        <div class="detail-item"><strong>Percentage</strong> <span>{{ student.diplomadetails.diploma_percentage }}%</span></div>
                        <div class="detail-item"><strong>Year of Passing</strong> <span>{{ student.diplomadetails.diploma_year_of_passing }}</span></div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- === SIDE CONTENT (RIGHT COLUMN) === -->
        <div class="side-content">
            <div class="card">
                <h2 class="card-title">Scholarship Details</h2>
                <div class="details-grid">
                    <div class="detail-item"><strong>Applying for Scholarship?</strong> <span>{% if student.scholarshipinfo.has_scholarship %}Yes{% else %}No{% endif %}</span></div>
                    {% if student.scholarshipinfo.has_scholarship %}
                    <div class="detail-item">
                        <strong>Scholarships</strong>
                        <ul class="scholarship-list">
                            {% if student.scholarshipinfo.is_first_graduate %}<li>First Graduate</li>{% endif %}
                            {% if student.scholarshipinfo.sch_bcmbc %}<li>BC/MBC</li>{% endif %}
                            {% if student.scholarshipinfo.sch_postmetric %}<li>Post Metric</li>{% endif %}
                            {% if student.scholarshipinfo.sch_pm %}<li>Prime Minister Scheme</li>{% endif %}
                            {% if student.scholarshipinfo.sch_govt %}<li>Govt 7.5%</li>{% endif %}
                            {% if student.scholarshipinfo.sch_pudhumai %}<li>Pudhumai Penn</li>{% endif %}
                            {% if student.scholarshipinfo.sch_tamizh %}<li>Tamizh Pudhalvan</li>{% endif %}
                            {% if student.scholarshipinfo.sch_private %}<li>Private: {{ student.scholarshipinfo.private_scholarship_name }}</li>{% endif %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Other Details</h2>
                <div class="details-grid">
                    <div class="detail-item"><strong>Ambition</strong> <span>{{ student.otherdetails.ambition|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Role Model</strong> <span>{{ student.otherdetails.role_model|default:"N/A" }}</span></div>
                    <div class="detail-item"><strong>Hobbies</strong> <span>{{ student.otherdetails.hobbies|default:"N/A" }}</span></div>
                </div>
            </div>

            <div class="card" id="documents-card">
                <h2 class="card-title">Uploaded Documents</h2>
                <div class="details-grid">
                    {% with doc=student.studentdocuments %}
                        <div class="detail-item"><strong>ID Card</strong> {% if doc.student_id_card %}<a href="{{ doc.student_id_card.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>Community Cert.</strong> {% if doc.community_certificate %}<a href="{{ doc.community_certificate.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>Aadhaar Card</strong> {% if doc.aadhaar_card %}<a href="{{ doc.aadhaar_card.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>First Graduate Cert.</strong> {% if doc.first_graduate_certificate %}<a href="{{ doc.first_graduate_certificate.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>SSLC Marksheet</strong> {% if doc.sslc_marksheet %}<a href="{{ doc.sslc_marksheet.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>HSC Marksheet</strong> {% if doc.hsc_marksheet %}<a href="{{ doc.hsc_marksheet.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>Income Cert.</strong> {% if doc.income_certificate %}<a href="{{ doc.income_certificate.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}</div>
                        <div class="detail-item"><strong>Bank Passbook</strong> {% if doc.bank_passbook %}<a href="{{ doc.bank_passbook.url }}" target="_blank">View</a>{% else %}<span>N/A</span>{% endif %}
                    {% endwith %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
