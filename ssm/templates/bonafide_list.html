{% extends 'stddash.html' %}
{% load static %}

{% block page_title %}Bonafide Requests | {{ student.student_name }}{% endblock %}

{% block header_title %}
<div style="display: flex; align-items: center; gap: 15px;">
    <a href="{% url 'student_dashboard' %}"
        style="text-decoration: none; color: #64748b; font-size: 1.5rem; line-height: 1; transition: color 0.2s;"
        onmouseover="this.style.color='#1e293b'" onmouseout="this.style.color='#64748b'" title="Back to Dashboard">
        &larr;
    </a>
    <h1 style="margin: 0;">ğŸ“œ Bonafide Requests</h1>
</div>
{% endblock %}

{% block header_actions %}
<button onclick="openBonafideModal()" class="action-btn"
    style="background: #5a7d7c; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: 0.9rem;">
    + New Request
</button>
{% endblock %}

{% block content %}
<div
    style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; margin-top: 20px;">



    {% if messages %}
    <div style="margin-bottom: 20px;">
        {% for message in messages %}
        <div
            style="padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            {% if message.tags == 'success' %}background: #f0fdf4; color: #166534; border-left: 5px solid #22c55e;
            {% elif message.tags == 'error' %}background: #fef2f2; color: #991b1b; border-left: 5px solid #ef4444;{% endif %}">
            <span>{% if message.tags == 'success' %}ğŸ‰{% else %}âš ï¸{% endif %}</span>
            <span style="font-weight: 500;">{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f8fafc; color: #64748b; text-align: left;">
                    <th style="padding: 15px; font-weight: 600; border-radius: 8px 0 0 8px;">Date</th>
                    <th style="padding: 15px; font-weight: 600;">Reason</th>
                    <th style="padding: 15px; font-weight: 600;">Status</th>

                </tr>
            </thead>
            <tbody>
                {% for req in requests %}
                <tr style="border-bottom: 1px solid #f1f5f9;">
                    <td style="padding: 15px; color: #334155;">{{ req.created_at|date:"d M Y" }}</td>
                    <td style="padding: 15px; color: #334155;">
                        {{ req.reason }}
                        {% if req.rejection_reason %}
                        <div
                            style="margin-top: 5px; font-size: 0.85rem; color: #ef4444; background: #fef2f2; padding: 5px 8px; border-radius: 4px; display: inline-block;">
                            <strong>Note:</strong> {{ req.rejection_reason }}
                        </div>
                        {% endif %}
                    </td>
                    <td style="padding: 15px;">
                        <span style="padding: 4px 10px; border-radius: 12px; font-size: 0.85rem; font-weight: 500; display: inline-block;
                            {% if 'Signed' in req.status %}background: #dbeafe; color: #1e40af; box-shadow: 0 2px 4px rgba(30, 64, 175, 0.1);
                            {% elif 'Collected' in req.status %}background: #d1fae5; color: #065f46; box-shadow: 0 2px 4px rgba(6, 95, 70, 0.1);
                            {% elif 'Rejected' in req.status %}background: #fee2e2; color: #991b1b; box-shadow: 0 2px 4px rgba(153, 27, 27, 0.1);
                            {% elif 'Pending' in req.status or 'Waiting' in req.status %}background: #fef9c3; color: #854d0e; box-shadow: 0 2px 4px rgba(133, 77, 14, 0.1);
                            {% else %}background: #f3f4f6; color: #1f2937;{% endif %}">
                            {{ req.status }}
                        </span>
                    </td>

                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" style="text-align: center; padding: 40px; color: #94a3b8;">
                        <p>No requests found. Click "+ New Request" to create one.</p>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}