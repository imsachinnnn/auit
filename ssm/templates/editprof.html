{% extends 'base2.html' %}
{% load static %}

{% block title %}Edit Profile - {{ student_name }}{% endblock title %}

{% block content %}
<div class="dashboard-container">
    <header class="page-header">
        <div class="title-group">
            <h1>Edit Your Profile</h1>
        </div>
        <div class="header-actions">
            <a href="{% url 'student_dashboard' %}" class="action-btn"
                style="background-color: var(--text-secondary);">← Back to Dashboard</a>
        </div>
    </header>

    <form method="POST" enctype="multipart/form-data" action="{% url 'edit_profile' %}">
        {% csrf_token %}

        <div class="card">
            <h2 class="card-title">Read-Only Information</h2>
            <div class="details-grid">
                <div class="detail-item">
                    <strong>Name</strong>
                    <span>{{ student.student_name }}</span>
                </div>
                <div class="detail-item">
                    <strong>Roll Number</strong>
                    <span>{{ student.roll_number }}</span>
                </div>
                <div class="detail-item">
                    <strong>Program</strong>
                    <span>{{ student.get_program_level_display }}</span>
                </div>
                <div class="detail-item">
                    <strong>Date of Birth</strong>
                    <span>{{ student.personalinfo.date_of_birth|date:"d M Y" }}</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">Update Your Contact Information</h2>
            <div class="details-grid">
                <div class="input-group">
                    <label for="student_email">Email Address</label>
                    <input type="email" id="student_email" name="student_email"
                        value="{{ student.student_email|default:'' }}" class="form-control">
                </div>
                <div class="input-group">
                    <label for="student_mobile">Your Mobile Number</label>
                    <input type="tel" id="student_mobile" name="student_mobile"
                        value="{{ student.personalinfo.student_mobile|default:'' }}" class="form-control">
                </div>
                <div class="input-group">
                    <label for="father_mobile">Father's Mobile</label>
                    <input type="tel" id="father_mobile" name="father_mobile"
                        value="{{ student.personalinfo.father_mobile|default:'' }}" class="form-control">
                </div>
                <div class="input-group">
                    <label for="mother_mobile">Mother's Mobile</label>
                    <input type="tel" id="mother_mobile" name="mother_mobile"
                        value="{{ student.personalinfo.mother_mobile|default:'' }}" class="form-control">
                </div>
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">Update Your Documents</h2>
            <p style="color: var(--text-secondary); margin-top: -15px; margin-bottom: 20px; font-size: 0.9em;">
                Only upload a file if you want to replace the existing one. Leave blank to keep the current document.
            </p>
            <div class="details-grid">
                <div class="input-group">
                    <label for="student_photo">Student Photo <span style="font-size:0.8em; color:#6c757d;">(Max:
                            100KB)</span></label>
                    {% if student.studentdocuments.student_photo %}
                    <small class="mb-2">Current: <a href="{{ student.studentdocuments.student_photo.url }}"
                            target="_blank">View Photo</a></small>
                    {% endif %}
                    <input type="file" id="student_photo" name="student_photo" accept="image/*" class="form-control">
                </div>
                <div class="input-group">
                    <label for="aadhaar_card">Aadhaar Card <span style="font-size:0.8em; color:#6c757d;">(Max:
                            100KB)</span></label>
                    {% if student.studentdocuments.aadhaar_card %}
                    <small class="mb-2">Current: <a href="{{ student.studentdocuments.aadhaar_card.url }}"
                            target="_blank">View Document</a></small>
                    {% endif %}
                    <input type="file" id="aadhaar_card" name="aadhaar_card" accept=".pdf,image/*" class="form-control">
                </div>
                <div class="input-group">
                    <label for="community_certificate">Community Certificate <span
                            style="font-size:0.8em; color:#6c757d;">(Max: 100KB)</span></label>
                    {% if student.studentdocuments.community_certificate %}
                    <small class="mb-2">Current: <a href="{{ student.studentdocuments.community_certificate.url }}"
                            target="_blank">View Document</a></small>
                    {% endif %}
                    <input type="file" id="community_certificate" name="community_certificate" accept=".pdf,image/*"
                        class="form-control">
                </div>
                <div class="input-group">
                    <label for="bank_passbook">Bank Passbook <span style="font-size:0.8em; color:#6c757d;">(Max:
                            100KB)</span></label>
                    {% if student.studentdocuments.bank_passbook %}
                    <small class="mb-2">Current: <a href="{{ student.studentdocuments.bank_passbook.url }}"
                            target="_blank">View Document</a></small>
                    {% endif %}
                    <input type="file" id="bank_passbook" name="bank_passbook" accept=".pdf,image/*"
                        class="form-control">
                </div>
            </div>
        </div>

        <div style="text-align: right; margin-top: 20px;">
            <button type="submit" class="action-btn" style="padding: 12px 40px; font-size: 1.1em;">✓ Save
                Changes</button>
        </div>

    </form>
</div>
{% endblock content %}

{% block scripts %}
<script src="{% static 'js/file-upload-validation.js' %}"></script>
{% endblock scripts %}