<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publications & Accomplishments | Staff Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="https://res.cloudinary.com/deocom5lr/image/upload/v1754117176/annamalai_kuoh1j.png"
        type="image/png">
    <style>
        :root {
            --primary: #5a7d7c;
            --primary-dark: #4a6b69;
            --primary-light: #eef2f2;
            --accent: #f59e0b;
            --bg-body: #f9fafb;
            --surface: #ffffff;
            --text-main: #111827;
            --text-muted: #6b7280;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --radius: 16px;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .app-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            min-height: 100vh;
        }

        .sidebar {
            background: var(--surface);
            border-right: 1px solid var(--border);
            padding: 24px;
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .brand img {
            height: 35px;
        }

        .brand h1 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
        }

        .nav-section {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 30px;
        }

        .nav-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 8px;
            padding-left: 12px;
            font-weight: 600;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            color: var(--text-muted);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-item:hover,
        .nav-item.active {
            background-color: var(--primary-light);
            color: var(--primary-dark);
        }

        .nav-icon {
            font-size: 1.1rem;
            width: 24px;
            text-align: center;
        }

        .profile-mini {
            margin-top: auto;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: var(--bg-body);
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .profile-mini img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .main-content {
            padding: 32px;
            max-width: 1000px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .top-bar {
            margin-bottom: 32px;
        }

        .page-title h2 {
            font-size: 1.75rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-main);
        }

        .page-title p {
            margin: 4px 0 0 0;
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .section-card {
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
            padding: 24px;
            margin-bottom: 24px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-dark);
            margin: 0;
        }

        .btn-add {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background 0.2s;
        }

        .btn-add:hover {
            background: var(--primary-dark);
            color: white;
        }

        .item-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .item-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
            gap: 16px;
        }

        .item-row:last-child {
            border-bottom: none;
        }

        .item-content {
            flex: 1;
            min-width: 0;
        }

        .item-title {
            font-weight: 600;
            color: var(--text-main);
            margin-bottom: 4px;
        }

        .item-meta {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .item-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .btn-edit,
        .btn-delete {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            text-decoration: none;
            transition: all 0.2s;
        }

        .btn-edit {
            background: var(--primary-light);
            color: var(--primary-dark);
        }

        .btn-edit:hover {
            background: var(--primary);
            color: white;
        }

        .btn-delete {
            background: #fee2e2;
            color: #dc2626;
        }

        .btn-delete:hover {
            background: #dc2626;
            color: white;
        }

        .empty-state {
            padding: 24px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .empty-state a {
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-main);
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-help {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .btn-save {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 8px;
        }

        @media (max-width: 1024px) {
            .app-container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <img src="https://res.cloudinary.com/deocom5lr/image/upload/v1754117176/annamalai_kuoh1j.png"
                    alt="Logo">
                <h1>Publications & Accomplishments</h1>
            </div>
            <nav class="nav-section">
                <a href="{% url 'staffs:staff_profile' %}" class="nav-item active">
                    <span class="nav-icon">‚Üê</span> Back to Profile
                </a>
            </nav>
            <nav class="nav-section">
                <div class="nav-label">Navigation</div>
                <a href="{% url 'staffs:staff_dashboard' %}" class="nav-item">
                    <span class="nav-icon">üìä</span> Dashboard
                </a>
            </nav>
            <div class="profile-mini">
                {% if staff.photo %}
                <img src="{{ staff.photo.url }}" alt="Profile">
                {% else %}
                <img src="https://ui-avatars.com/api/?name={{ staff.name }}" alt="Profile">
                {% endif %}
                <div style="flex: 1; min-width: 0; font-weight: 600; font-size: 0.9rem;">{{ staff.name }}</div>
            </div>
        </aside>

        <main class="main-content">
            <div class="top-bar">
                <div class="page-title">
                    <h2>Publications & Accomplishments</h2>
                    <p>Click "Add New" to add publications, awards, memberships, or students guided.</p>
                </div>
            </div>

            {% if messages %}
            <ul style="list-style: none; padding: 0; margin: 0 0 20px 0;">
                {% for message in messages %}
                <li style="padding: 12px; border-radius: 8px; background: #d1fae5; color: #065f46; margin-bottom: 8px;">
                    {{ message }}</li>
                {% endfor %}
            </ul>
            {% endif %}


            <!-- Tabs Navigation -->
            <div style="display: flex; gap: 10px; margin-bottom: 24px; border-bottom: 2px solid var(--border);">
                <button onclick="openTab(event, 'Conferences')" class="tab-link active">Conferences</button>
                <button onclick="openTab(event, 'Publications')" class="tab-link">Publications (Journal)</button>
                <button onclick="openTab(event, 'Books')" class="tab-link">Books / Popular Articles</button>
                <button onclick="openTab(event, 'Others')" class="tab-link">Awards & Guided</button>
            </div>

            <style>
                .tab-link {
                    background: none;
                    border: none;
                    padding: 12px 16px;
                    font-size: 1rem;
                    font-weight: 500;
                    color: var(--text-muted);
                    cursor: pointer;
                    border-bottom: 2px solid transparent;
                    margin-bottom: -2px;
                }

                .tab-link.active {
                    color: var(--primary);
                    border-bottom: 2px solid var(--primary);
                    font-weight: 600;
                }

                .tab-content {
                    display: none;
                }

                .tab-content.active {
                    display: block;
                }

                /* Modal Styles */
                .modal {
                    display: none;
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: rgba(0, 0, 0, 0.5);
                    z-index: 1000;
                    align-items: center;
                    /* Flexbox centering for modal overlay */
                    justify-content: center;
                }

                .modal-content {
                    background: white;
                    margin: 20px;
                    padding: 0;
                    /* Removing padding from container to let children handle it */
                    width: 90%;
                    max-width: 800px;
                    border-radius: 12px;
                    max-height: 90vh;
                    /* Increased max-height */
                    display: flex;
                    flex-direction: column;
                    overflow: hidden;
                    /* Ensure rounded corners clip content */
                    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
                }

                .modal-header {
                    padding: 20px 24px;
                    border-bottom: 1px solid var(--border);
                    flex-shrink: 0;
                    display: flex;
                    justify-content: center;
                    /* Center the title */
                    align-items: center;
                    position: relative;
                }

                .modal-header h3 {
                    margin: 0;
                    flex-grow: 1;
                    text-align: center;
                    font-size: 1.25rem;
                }

                .modal-close {
                    background: none;
                    border: none;
                    font-size: 1.5rem;
                    cursor: pointer;
                    color: var(--text-muted);
                    position: absolute;
                    right: 24px;
                    top: 50%;
                    transform: translateY(-50%);
                }

                .modal-content form {
                    display: flex;
                    flex-direction: column;
                    flex: 1;
                    min-height: 0;
                    overflow: hidden;
                    padding: 0;
                    margin: 0;
                }

                .form-grid {
                    flex: 1;
                    overflow-y: auto;
                    padding: 24px;
                    min-height: 0;
                }

                .btn-save {
                    margin: 0;
                    padding: 16px 24px;
                    width: 100%;
                    border-radius: 0;
                    background: var(--primary);
                    color: white;
                    font-weight: 600;
                    flex-shrink: 0;
                    border: none;
                    cursor: pointer;
                    text-align: center;
                }





                .full-width {
                    grid-column: span 2;
                }
            </style>

            <!-- 1. Conferences Tab -->
            <div id="Conferences" class="tab-content active">
                <div class="section-card">
                    <div class="section-header">
                        <h3 class="section-title">Conference Participation</h3>
                        <button onclick="openModal('modalConference')" class="btn-add">‚ûï Add Conference</button>
                    </div>
                    {% if conferences %}
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                            <thead style="background: var(--bg-body); text-align: left;">
                                <tr>
                                    <th style="padding: 10px;">Title</th>
                                    <th style="padding: 10px;">Proceedings</th>
                                    <th style="padding: 10px;">Author(s)</th>
                                    <th style="padding: 10px;">Date/Place</th>
                                    <th style="padding: 10px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for c in conferences %}
                                <tr style="border-bottom: 1px solid var(--border);">
                                    <td style="padding: 10px;">
                                        {% if c.participation_type == 'Attended' %}
                                        <b>{{ c.title_of_proceedings }}</b>
                                        {% else %}
                                        <b>{{ c.title_of_paper }}</b>
                                        {% endif %}
                                        <br>
                                        <span style="font-size:0.8rem; color:var(--text-muted);">
                                            {{ c.participation_type }} ¬∑ {{ c.national_international }}
                                            {% if c.year_of_publication %}¬∑ {{ c.year_of_publication }}{% endif %}
                                        </span>
                                    </td>
                                    <td style="padding: 10px;">
                                        {% if c.participation_type == 'Presented' %}
                                        {{ c.title_of_proceedings }}
                                        {% else %}
                                        -
                                        {% endif %}
                                    </td>
                                    <td style="padding: 10px;">{{ c.author_name }}<br>
                                        {% if c.supporting_document %}
                                        <a href="{{ c.supporting_document.url }}" target="_blank"
                                            style="font-size:0.8rem; color:var(--primary);">View Cert/Paper</a>
                                        {% endif %}
                                    </td>
                                    <td style="padding: 10px;">{{ c.date_from|default:"-" }} to {{ c.date_to|default:"-" }}<br>{{ c.location }}</td>
                                    <td style="padding: 10px;">
                                        <a href="{% url 'staffs:portfolio_delete_entry' 'conference' c.pk %}"
                                            class="btn-delete" onclick="return confirm('Delete this entry?')">Delete</a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="empty-state">No conference entries added.</div>
                    {% endif %}
                </div>
            </div>

            <!-- 2. Publications Tab -->
            <div id="Publications" class="tab-content">
                <div class="section-card">
                    <div class="section-header">
                        <h3 class="section-title">Journal Publications</h3>
                        <button onclick="openModal('modalJournal')" class="btn-add">‚ûï Add Journal</button>
                    </div>
                    {% if journals %}
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                            <thead style="background: var(--bg-body); text-align: left;">
                                <tr>
                                    <th style="padding: 10px;">Title</th>
                                    <th style="padding: 10px;">Journal</th>
                                    <th style="padding: 10px;">Author(s)</th>
                                    <th style="padding: 10px;">Vol/Issue</th>
                                    <th style="padding: 10px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for j in journals %}
                                <tr style="border-bottom: 1px solid var(--border);">
                                    <td style="padding: 10px;"><b>{{ j.title_of_paper }}</b><br><span
                                            style="font-size:0.8rem; color:var(--text-muted);">{{
                                            j.national_international }} ¬∑ {{ j.published_month }} {{ j.published_year
                                            }}</span></td>
                                    <td style="padding: 10px;">{{ j.journal_name }}<br><span
                                            style="font-size:0.8rem;">DOI/Year: {{ j.year_of_publication_doi }}</span>
                                    </td>
                                    <td style="padding: 10px;">{{ j.author_name }}<br>
                                        {% if j.supporting_document %}
                                        <a href="{{ j.supporting_document.url }}" target="_blank"
                                            style="font-size:0.8rem; color:var(--primary);">View Paper</a>
                                        {% endif %}
                                    </td>
                                    <td style="padding: 10px;">Vol: {{ j.volume_number }}<br>Iss: {{ j.issue_number }}
                                    </td>
                                    <td style="padding: 10px;">
                                        <a href="{% url 'staffs:portfolio_delete_entry' 'journal' j.pk %}"
                                            class="btn-delete" onclick="return confirm('Delete this entry?')">Delete</a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="empty-state">No journal publications added.</div>
                    {% endif %}
                </div>
            </div>

            <!-- 3. Books Tab -->
            <div id="Books" class="tab-content">
                <div class="section-card">
                    <div class="section-header">
                        <h3 class="section-title">Books / Popular Articles</h3>
                        <button onclick="openModal('modalBook')" class="btn-add">‚ûï Add Book/Article</button>
                    </div>
                    {% if books %}
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                            <thead style="background: var(--bg-body); text-align: left;">
                                <tr>
                                    <th style="padding: 10px;">Title</th>
                                    <th style="padding: 10px;">Type</th>
                                    <th style="padding: 10px;">Author(s)</th>
                                    <th style="padding: 10px;">Publisher</th>
                                    <th style="padding: 10px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for b in books %}
                                <tr style="border-bottom: 1px solid var(--border);">
                                    <td style="padding: 10px;"><b>{{ b.title_of_book }}</b><br><span
                                            style="font-size:0.8rem; color:var(--text-muted);">{{ b.month_of_publication
                                            }} {{ b.year_of_publication }}</span></td>
                                    <td style="padding: 10px;">{{ b.type }}</td>
                                    <td style="padding: 10px;">{{ b.author_name }}<br>
                                        {% if b.supporting_document %}
                                        <a href="{{ b.supporting_document.url }}" target="_blank"
                                            style="font-size:0.8rem; color:var(--primary);">View Cover</a>
                                        {% endif %}
                                    </td>
                                    <td style="padding: 10px;">{{ b.publisher_name }}<br><span
                                            style="font-size:0.8rem;">ISBN: {{ b.isbn_issn_number }}</span></td>
                                    <td style="padding: 10px;">
                                        <a href="{% url 'staffs:portfolio_delete_entry' 'book' b.pk %}"
                                            class="btn-delete" onclick="return confirm('Delete this entry?')">Delete</a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="empty-state">No books or popular articles added.</div>
                    {% endif %}
                </div>
            </div>

            <!-- 4. Others Tab (Existing) -->
            <div id="Others" class="tab-content">
                <div class="section-card">
                    <div class="section-header">
                        <h3 class="section-title">Seminars / Workshops (Legacy)</h3>
                        <button onclick="openModal('modalSeminar')" class="btn-add">‚ûï Add Seminar</button>
                    </div>
                    {% if seminars %}
                    <ul class="item-list">
                        {% for s in seminars %}
                        <li class="item-row">
                            <div class="item-content">
                                <div class="item-title">{{ s.title }} ({{ s.get_event_type_display }})</div>
                                <div class="item-meta">
                                    {{ s.venue_or_description }} ¬∑ {{ s.year }}
                                    {% if s.date_from %}
                                    ¬∑ {{ s.date_from|date:"d M Y" }}
                                    {% if s.date_to %}
                                    - {{ s.date_to|date:"d M Y" }}
                                    {% endif %}
                                    {% endif %}

                                    {% if s.supporting_document %}
                                    <br><a href="{{ s.supporting_document.url }}" target="_blank"
                                        style="font-size:0.85rem; color:var(--primary);">View Certificate</a>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="item-actions">
                                <a href="{% url 'staffs:portfolio_delete_entry' 'seminar' s.pk %}"
                                    class="btn-delete">Delete</a>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <div class="empty-state">No legacy seminar entries.</div>
                    {% endif %}
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <h3 class="section-title">Awards / Honours</h3>
                        <button onclick="openModal('modalAward')" class="btn-add">‚ûï Add Award</button>
                    </div>
                    {% if awards %}
                    <ul class="item-list">
                        {% for a in awards %}
                        <li class="item-row">
                            <div class="item-content">
                                <div class="item-title">{{ a.title }} ({{ a.get_category_display }}){% if a.awarded_by%}
                                    - {{ a.awarded_by }}{% endif %}
                                    {% if a.supporting_document %}
                                    <span style="margin-left:8px;">
                                        <a href="{{ a.supporting_document.url }}" target="_blank"
                                            style="font-size:0.85rem; color:var(--primary);">[View Cert]</a>
                                    </span>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="item-actions">
                                <a href="{% url 'staffs:portfolio_delete_entry' 'award' a.pk %}"
                                    class="btn-delete">Delete</a>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <div class="empty-state">No awards added.</div>
                    {% endif %}
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <h3 class="section-title">Students Guided</h3>
                        <button onclick="openModal('modalStudent')" class="btn-add">‚ûï Add Student</button>
                    </div>
                    {% if students_guided %}
                    <ul class="item-list">
                        {% for s in students_guided %}
                        <li class="item-row">
                            <div class="item-content">
                                <div class="item-title">{{ s.student_name }} ¬∑ {{ s.degree_type }}
                                    {% if s.supporting_document %}
                                    <span style="margin-left:8px;">
                                        <a href="{{ s.supporting_document.url }}" target="_blank"
                                            style="font-size:0.85rem; color:var(--primary);">[View Doc]</a>
                                    </span>
                                    {% endif %}
                                </div>
                            </div>
                            <div class="item-actions">
                                <a href="{% url 'staffs:portfolio_delete_entry' 'student_guided' s.pk %}"
                                    class="btn-delete">Delete</a>
                            </div>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <div class="empty-state">No students guided added.</div>
                    {% endif %}
                </div>
            </div>

            <!-- MODALS -->

            <!-- Conference Modal -->
            <div id="modalConference" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add Conference Participation</h3>
                        <button onclick="closeModal('modalConference')" class="modal-close">√ó</button>
                    </div>
                    <form action="{% url 'staffs:portfolio_add_conference' %}" method="POST"
                        enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>National / International</label>
                                <div style="display:flex; gap:20px;">
                                    <label style="font-weight:normal;"><input type="radio" name="national_international"
                                            value="National" checked> National</label>
                                    <label style="font-weight:normal;"><input type="radio" name="national_international"
                                            value="International"> International</label>
                                </div>
                            </div>
                            <!-- Participation Type Selection -->
                            <div class="form-group full-width">
                                <label>Participation Type</label>
                                <div style="display:flex; gap:20px;">
                                    <label style="font-weight:normal;">
                                        <input type="radio" name="participation_type" value="Presented" checked
                                            onchange="toggleConferenceFields()"> Presented Paper
                                    </label>
                                    <label style="font-weight:normal;">
                                        <input type="radio" name="participation_type" value="Attended"
                                            onchange="toggleConferenceFields()"> Attended Only
                                    </label>
                                </div>
                            </div>

                            <div class="paper-field form-group">
                                <label>Author(s) Name</label>
                                <input type="text" name="author_name" id="conf_author_name">
                            </div>
                            <div class="form-group">
                                <label>Year of Publication</label>
                                <input type="text" name="year_of_publication">
                            </div>
                            <div class="paper-field form-group full-width">
                                <label>Title of Paper</label>
                                <input type="text" name="title_of_paper" id="conf_title_of_paper">
                            </div>
                            <div class="form-group full-width">
                                <label id="lbl_proceedings">Title of Conference Proceedings</label>
                                <input type="text" name="title_of_proceedings">
                            </div>
                            <div class="form-group">
                                <label>Date From</label>
                                <input type="date" name="date_from">
                            </div>
                            <div class="form-group">
                                <label>Date To</label>
                                <input type="date" name="date_to">
                            </div>
                            <div class="form-group full-width">
                                <label>Location of Conference</label>
                                <input type="text" name="location">
                            </div>
                            <div class="paper-field form-group">
                                <label>Page Numbers From</label>
                                <input type="text" name="page_numbers_from">
                            </div>
                            <div class="paper-field form-group">
                                <label>Page Numbers To</label>
                                <input type="text" name="page_numbers_to">
                            </div>
                            <div class="paper-field form-group full-width">
                                <label>Place of Publication</label>
                                <input type="text" name="place_of_publication">
                            </div>
                            <div class="paper-field form-group full-width">
                                <label>Publisher of Proceedings</label>
                                <input type="text" name="publisher_proceedings">
                            </div>
                            <div class="form-group full-width">
                                <label>Supporting Document (PDF/Image)</label>
                                <input type="file" name="supporting_document">
                                <div class="form-help">Upload Certificate / Paper Copy</div>
                            </div>
                        </div>
                        <button type="submit" class="btn-save">Save Entry</button>
                    </form>
                </div>
            </div>

            <!-- Journal Modal -->
            <div id="modalJournal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add Journal Publication</h3>
                        <button onclick="closeModal('modalJournal')" class="modal-close">√ó</button>
                    </div>
                    <form action="{% url 'staffs:portfolio_add_journal' %}" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>National / International</label>
                                <div style="display:flex; gap:20px;">
                                    <label style="font-weight:normal;"><input type="radio" name="national_international"
                                            value="National" checked> National</label>
                                    <label style="font-weight:normal;"><input type="radio" name="national_international"
                                            value="International"> International</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Published Month</label>
                                <select name="published_month">
                                    <option value="">Select Month</option>
                                    <option value="January">January</option>
                                    <option value="February">February</option>
                                    <option value="March">March</option>
                                    <option value="April">April</option>
                                    <option value="May">May</option>
                                    <option value="June">June</option>
                                    <option value="July">July</option>
                                    <option value="August">August</option>
                                    <option value="September">September</option>
                                    <option value="October">October</option>
                                    <option value="November">November</option>
                                    <option value="December">December</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Published Year</label>
                                <input type="number" name="published_year" placeholder="YYYY">
                            </div>
                            <div class="form-group full-width">
                                <label>Author(s) Name</label>
                                <input type="text" name="author_name" required>
                            </div>
                            <div class="form-group full-width">
                                <label>Title of Paper</label>
                                <input type="text" name="title_of_paper" required>
                            </div>
                            <div class="form-group full-width">
                                <label>Journal Name</label>
                                <input type="text" name="journal_name" required>
                            </div>
                            <div class="form-group">
                                <label>Volume Number</label>
                                <input type="text" name="volume_number">
                            </div>
                            <div class="form-group">
                                <label>Issue Number</label>
                                <input type="text" name="issue_number">
                            </div>
                            <div class="form-group full-width">
                                <label>Year of Publication / DOI</label>
                                <input type="text" name="year_of_publication_doi">
                            </div>
                            <div class="form-group">
                                <label>Page Numbers From</label>
                                <input type="text" name="page_numbers_from">
                            </div>
                            <div class="form-group">
                                <label>Page Numbers To</label>
                                <input type="text" name="page_numbers_to">
                            </div>
                            <div class="form-group full-width">
                                <label>Supporting Document</label>
                                <input type="file" name="supporting_document">
                                <div class="form-help">Upload Paper Copy</div>
                            </div>
                        </div>
                        <button type="submit" class="btn-save">Save Entry</button>
                    </form>
                </div>
            </div>

            <!-- Book Modal -->
            <div id="modalBook" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add Book / Popular Article</h3>
                        <button onclick="closeModal('modalBook')" class="modal-close">√ó</button>
                    </div>
                    <form action="{% url 'staffs:portfolio_add_book' %}" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>Publication Type</label>
                                <div style="display:flex; gap:20px;">
                                    <label style="font-weight:normal;"><input type="radio" name="type" value="Book"
                                            checked>
                                        Book</label>
                                    <label style="font-weight:normal;"><input type="radio" name="type"
                                            value="Popular Article">
                                        Popular Article</label>
                                </div>
                            </div>
                            <div class="form-group full-width">
                                <label>Author(s) Name</label>
                                <input type="text" name="author_name" required>
                            </div>
                            <div class="form-group full-width">
                                <label>Title of Book</label>
                                <input type="text" name="title_of_book" required>
                            </div>
                            <div class="form-group full-width">
                                <label>Publisher Name</label>
                                <input type="text" name="publisher_name">
                            </div>
                            <div class="form-group full-width">
                                <label>Publisher Address</label>
                                <textarea name="publisher_address" style="min-height:60px;"></textarea>
                            </div>
                            <div class="form-group full-width">
                                <label>ISBN / ISSN Number</label>
                                <input type="text" name="isbn_issn_number">
                            </div>
                            <div class="form-group">
                                <label>Page Numbers From</label>
                                <input type="text" name="page_numbers_from">
                            </div>
                            <div class="form-group">
                                <label>Page Numbers To</label>
                                <input type="text" name="page_numbers_to">
                            </div>
                            <div class="form-group">
                                <label>Month of Publication</label>
                                <select name="month_of_publication">
                                    <option value="">Select Month</option>
                                    <option value="January">January</option>
                                    <option value="February">February</option>
                                    <option value="March">March</option>
                                    <option value="April">April</option>
                                    <option value="May">May</option>
                                    <option value="June">June</option>
                                    <option value="July">July</option>
                                    <option value="August">August</option>
                                    <option value="September">September</option>
                                    <option value="October">October</option>
                                    <option value="November">November</option>
                                    <option value="December">December</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Year of Publication</label>
                                <input type="number" name="year_of_publication" placeholder="YYYY">
                            </div>
                            <div class="form-group full-width">
                                <label>URL Address</label>
                                <input type="url" name="url_address" placeholder="https://example.com">
                            </div>
                            <div class="form-group full-width">
                                <label>Supporting Document</label>
                                <input type="file" name="supporting_document">
                                <div class="form-help">Upload Cover Page / Proof</div>
                            </div>
                        </div>
                        <button type="submit" class="btn-save">Save Entry</button>
                    </form>
                </div>
            </div>

            <!-- Seminar Modal -->
            <div id="modalSeminar" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add Seminar / Workshop</h3>
                        <button onclick="closeModal('modalSeminar')" class="modal-close">√ó</button>
                    </div>
                    <form action="{% url 'staffs:portfolio_add_seminar' %}" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>Title of Event</label>
                                <input type="text" name="title" required>
                            </div>
                            <div class="form-group">
                                <label>Event Type</label>
                                <select name="event_type">
                                    <option value="Seminar">Seminar</option>
                                    <option value="Workshop">Workshop</option>
                                    <option value="Conference">Conference</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Year</label>
                                <input type="text" name="year" placeholder="e.g. 2023-2024">
                            </div>
                            <div class="form-group full-width">
                                <label>Venue / Description</label>
                                <input type="text" name="venue_or_description">
                            </div>
                            <div class="form-group">
                                <label>Date From</label>
                                <input type="date" name="date_from">
                            </div>
                            <div class="form-group">
                                <label>Date To</label>
                                <input type="date" name="date_to">
                            </div>
                            <div class="form-group full-width">
                                <label>Supporting Document</label>
                                <input type="file" name="supporting_document">
                                <div class="form-help">Upload Certificate</div>
                            </div>
                        </div>
                        <button type="submit" class="btn-save">Save Entry</button>
                    </form>
                </div>
            </div>

            <!-- Award Modal -->
            <div id="modalAward" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add Award / Honour</h3>
                        <button onclick="closeModal('modalAward')" class="modal-close">√ó</button>
                    </div>
                    <form action="{% url 'staffs:portfolio_add_award' %}" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>Title</label>
                                <input type="text" name="title" required>
                            </div>
                            <div class="form-group full-width">
                                <label>Awarded By</label>
                                <input type="text" name="awarded_by" placeholder="Organization Name">
                            </div>
                            <div class="form-group full-width">
                                <label>Description/Details</label>
                                <textarea name="description" style="min-height:60px;"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select name="category">
                                    <option value="Award">Award</option>
                                    <option value="Honour">Honour</option>
                                    <option value="Membership">Membership</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Year</label>
                                <input type="text" name="year">
                            </div>
                            <div class="form-group full-width">
                                <label>Supporting Document</label>
                                <input type="file" name="supporting_document">
                                <div class="form-help">Upload Certificate/Letter</div>
                            </div>
                        </div>
                        <button type="submit" class="btn-save">Save Entry</button>
                    </form>
                </div>
            </div>

            <!-- Student Modal -->
            <div id="modalStudent" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add Student Guided</h3>
                        <button onclick="closeModal('modalStudent')" class="modal-close">√ó</button>
                    </div>
                    <form action="{% url 'staffs:portfolio_add_student' %}" method="POST" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>Student Name</label>
                                <input type="text" name="student_name" required>
                            </div>
                            <div class="form-group">
                                <label>Degree Type</label>
                                <select name="degree_type">
                                    <option value="PG">PG (M.Tech, M.Sc)</option>
                                    <option value="PhD">PhD</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select name="status">
                                    <option value="Ongoing">Ongoing</option>
                                    <option value="Completed">Completed</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Year</label>
                                <input type="text" name="year">
                            </div>
                            <div class="form-group full-width">
                                <label>Supporting Document (PDF/Image)</label>
                                <input type="file" name="supporting_document">
                                <div class="form-help">Upload Memo / Provisional Certificate / Allocation Order</div>
                            </div>
                        </div>
                        <button type="submit" class="btn-save">Save Entry</button>
                    </form>
                </div>
            </div>

            <script>
                /* Modal Logic */
                // Ensure correct state on load
                toggleConferenceFields();

                function toggleConferenceFields() {
                    const type = document.querySelector('input[name="participation_type"]:checked').value;
                    const paperFields = document.querySelectorAll('.paper-field');
                    const lblProceedings = document.getElementById('lbl_proceedings');

                    if (type === 'Attended') {
                        paperFields.forEach(el => el.style.display = 'none');
                        document.getElementById('conf_title_of_paper').required = false;
                        document.getElementById('conf_author_name').required = false;
                        if (lblProceedings) lblProceedings.innerText = "Conference Name"; // Reuse this field
                    } else {
                        paperFields.forEach(el => el.style.display = 'block');
                        document.getElementById('conf_title_of_paper').required = true;
                        document.getElementById('conf_author_name').required = true;
                        if (lblProceedings) lblProceedings.innerText = "Title of Conference Proceedings";
                    }
                }

                function openTab(evt, tabName) {
                    var i, tabcontent, tablinks;
                    tabcontent = document.getElementsByClassName("tab-content");
                    for (i = 0; i < tabcontent.length; i++) {
                        tabcontent[i].style.display = "none";
                        tabcontent[i].classList.remove("active");
                    }
                    tablinks = document.getElementsByClassName("tab-link");
                    for (i = 0; i < tablinks.length; i++) {
                        tablinks[i].className = tablinks[i].className.replace(" active", "");
                    }
                    document.getElementById(tabName).style.display = "block";
                    evt.currentTarget.className += " active";
                }

                // Auto open first tab
                document.addEventListener('DOMContentLoaded', function () {
                    var firstTab = document.getElementsByClassName('tab-link')[0];
                    if (firstTab) firstTab.click();
                });

                function openModal(modalId) {
                    document.getElementById(modalId).style.display = "block";
                }

                function closeModal(modalId) {
                    document.getElementById(modalId).style.display = "none";
                }

                // Close modal when clicking outside
                window.onclick = function (event) {
                    if (event.target.classList.contains('modal')) {
                        event.target.style.display = "none";
                    }
                }
            </script>
    </div>
    <script>
        // Remove the leftover duplicate script block
        var duplicateScript = document.currentScript;
        duplicateScript.parentNode.removeChild(duplicateScript);
    </script>

    </main>
    </div>
</body>

</html>